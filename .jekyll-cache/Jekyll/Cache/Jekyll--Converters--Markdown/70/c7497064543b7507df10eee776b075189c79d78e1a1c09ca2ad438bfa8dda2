I"Øb<h2 id="é¢˜ç›®">é¢˜ç›®</h2>

<p>Final Project, Selected topics (not limited to):</p>

<ol>
  <li>Parallel Monte Carlo algorithm;</li>
  <li>Parallellinearsolver;</li>
  <li>Parallel QR factorization or linear least squares;</li>
  <li>Parallelbenchmarks;</li>
  <li>Dynamicloadbalancing;</li>
  <li>Parallel sorting or selection;</li>
  <li>Parallelgraphpartitioning;</li>
</ol>

<p>Implement with MPI or MapReduce or OpenMP or CUDA â€¦</p>

<h2 id="è¯´æ˜">è¯´æ˜</h2>

<p>ä½¿ç”¨OpenMPå®ç°äº†å¹¶è¡Œç‰ˆæœ¬çš„å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼Œå¹¶ä¸ä¸²è¡Œç‰ˆæœ¬çš„å‚…é‡Œå¶å˜æ¢ç»“æœä½œæ¯”è¾ƒï¼ŒéªŒè¯å…¶æ­£ç¡®æ€§å¹¶å¯¹æ¯”è¿è¡Œæ—¶é—´ã€‚</p>

<h3 id="åˆ†æ">åˆ†æ</h3>

<p>å‚…é‡Œå¶å˜æ¢å¸¸ç”¨äºåŠ é€Ÿå¤šé¡¹å¼ä¹˜æ³•ï¼Œè€Œå¸¸è§„çš„å¿«é€Ÿå‚…é‡Œå¶å˜æ¢ï¼ˆåŸç†ç•¥ï¼‰é€šå¸¸æ˜¯ä½¿ç”¨é€’å½’å®ç°çš„ï¼Œä½¿ç”¨å¹¶è¡Œä¼˜åŒ–çš„éš¾åº¦æ¯”è¾ƒé«˜ã€‚å› æ­¤ï¼Œæˆ‘åœ¨è¿™é‡Œå®ç°äº†éè¿­ä»£çš„å¿«é€Ÿå‚…é‡Œå¶ç‰ˆæœ¬ï¼šå…ˆé¢„å¤„ç†æ¯ä¸ªä½ç½®ä¸Šå…ƒç´ å˜æ¢åçš„ä½ç½®ï¼ˆæ¯ä¸ªä½ç½®åˆ†æ²»åçš„æœ€ç»ˆä½ç½®ä¸ºå…¶äºŒè¿›åˆ¶ç¿»è½¬åå¾—åˆ°çš„ä½ç½®ï¼‰ï¼Œç„¶åå…ˆå°†æ‰€æœ‰å…ƒç´ ç§»åˆ°å˜æ¢åçš„ä½ç½®ä¹‹åç›´æ¥å¾ªç¯åˆå¹¶ã€‚</p>

<blockquote>
  <p>æ‰¾å˜æ¢ä½ç½®è¿™é‡Œå…¶å®æœ‰ä¸€ä¸ªç»å…¸ç®—æ³•å«é›·å¾·ç®—æ³•ï¼Œåˆè¢«ç§°ä½œè´è¶å˜æ¢ï¼›ä¸è¿‡æˆ‘æ²¡æœ‰ä½¿ç”¨è¿™ä¸€ç®—æ³•ï¼Œå› ä¸ºè´è¶å˜æ¢æœ‰ä¸€å®šçš„å¾ªç¯ä¾èµ–æ€§ï¼Œå¾ˆéš¾å¹¶è¡Œä¼˜åŒ–ã€‚</p>
</blockquote>

<p>éšåï¼Œè°ƒæ•´å®Œå¾ªç¯é¡ºåºä¹‹åï¼Œç¬¬ä¸€å±‚å¾ªç¯å˜é‡iè¡¨ç¤ºæ¯ä¸€å±‚å˜æ¢çš„è·¨åº¦ï¼Œç¬¬äºŒå±‚å¾ªç¯å˜é‡jè¡¨ç¤ºæ¯ä¸€å±‚å˜æ¢çš„ç¬¬ä¸€ä¸ªèµ·ç‚¹ï¼Œç¬¬ä¸‰å±‚å¾ªç¯éå†kåˆ™è¡¨ç¤ºå®é™…å˜æ¢çš„ä½ç½®$k$å’Œ$k+i$ã€‚åœ¨è¿™é‡Œï¼Œä»ç¬¬äºŒå±‚å¼€å§‹æ˜¯æ²¡æœ‰å¾ªç¯ä¾èµ–çš„ï¼Œå³å¯¹äºä¸åŒçš„jï¼Œç®—æ³•ä¸ä¼šå¯¹åŒä¸€å—åœ°å€è¿›è¡Œè®¿é—®ï¼ˆå› ä¸ºè®¿é—®çš„ä¸‹æ ‡$k\equiv j\pmod{i}$ä¸”$k+i\equiv j\pmod{i}$ï¼‰ã€‚</p>

<p>ä½œä¸ºå…¬å¹³èµ·è§ï¼Œç”¨äºå¯¹æ¯”çš„ä¸²è¡Œç‰ˆæœ¬å¿«é€Ÿå‚…é‡Œå¶å˜æ¢æ˜¯ç›´æ¥åœ¨å¹¶è¡Œç‰ˆæœ¬ä¸Šåˆ å»ç¼–è¯‘æ¨å¯¼<code class="highlighter-rouge">#pragma omp for</code>å¾—åˆ°çš„ã€‚è¿™æ˜¯å› ä¸ºé€’å½’ç‰ˆæœ¬çš„å¿«é€Ÿå‚…é‡Œå¶å˜æ¢é€šå¸¸æœ‰è¾ƒå¤§çš„å‡½æ•°é€’å½’å¼€é”€ã€‚</p>

<h3 id="ç¼–è¯‘">ç¼–è¯‘</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>g++ ParallelFastFourierTransform.cpp <span class="nt">-oParallelFastFourierTransform</span> <span class="nt">-fopenmp</span>
</code></pre></div></div>

<h3 id="è¿è¡Œ">è¿è¡Œ</h3>

<p>æ¥å—ä¸¤ä¸ªè¿è¡Œå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¹¶è¡Œéƒ¨åˆ†ä½¿ç”¨çš„çº¿ç¨‹æ•°é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯å‚…é‡Œå¶å˜æ¢çš„é•¿åº¦çš„æŒ‡æ•°ï¼ˆä¾‹å¦‚ï¼Œå½“è®¾ä¸º10çš„æ—¶å€™ï¼Œå‚…é‡Œå¶å˜æ¢çš„é•¿åº¦å°±æ˜¯$2^{10}=1024$ï¼›è¿™æ ·åšæ˜¯å› ä¸ºç®—æ³•æœ¬èº«å°±è¦æ±‚é•¿åº¦ä¸ºäºŒçš„å¹‚æ¬¡ï¼‰ã€‚</p>

<p>è€ƒè™‘åˆ°å˜æ¢çš„é•¿åº¦å¯èƒ½å¾ˆé•¿ï¼Œæˆ‘è¿™é‡Œç›´æ¥ä½¿ç”¨ç¨‹åºè‡ªå·±ç”Ÿæˆçš„åºåˆ—è¿›è¡Œå˜æ¢äº†ï¼ˆè¿™ä¸ªç¨‹åºä»…ç”¨äºéªŒè¯ç®—æ³•çš„æ­£ç¡®æ€§ï¼‰ã€‚</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./ParallelFastFourierTransform &lt;num-of-threads&gt; &lt;power-of-transform-length&gt;
</code></pre></div></div>

<h3 id="ç»“æœ">ç»“æœ</h3>

<p>æˆ‘çš„è½¯ç¡¬ä»¶é…ç½®æ˜¯ï¼š</p>

<ul>
  <li>VAIO Z Flip 2016</li>
  <li>Intel(R) Core(TM) i7-6567U CPU @3.30GHZ 3.31GHz</li>
  <li>8.00GB RAM</li>
  <li>Windows 10.0.18362.175, 64-bit</li>
  <li>Windows Subsystem for Linux [Ubuntu 18.04.2 LTS]ï¼šWSLæ˜¯ä»¥è½¯ä»¶çš„å½¢å¼è¿è¡Œåœ¨Windowsä¸‹çš„Linuxå­ç³»ç»Ÿï¼Œæ˜¯è¿‘äº›å¹´å¾®è½¯æ¨å‡ºæ¥çš„æ–°å·¥å…·ï¼Œå¯ä»¥åœ¨Windowsç³»ç»Ÿä¸ŠåŸç”Ÿè¿è¡ŒLinuxã€‚</li>
  <li>gcc version 7.3.0 (Ubuntu 7.3.0-27ubuntu1~18.04)ï¼šCè¯­è¨€ç¨‹åºç¼–è¯‘å™¨ï¼ŒUbuntuè‡ªå¸¦ã€‚</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>./ParallelFastFourierTransform 1 22
Serial Time: 4.29194s
Parallel Time: 4.32889s
<span class="nv">$ </span>./ParallelFastFourierTransform 2 22
Serial Time: 4.30011s
Parallel Time: 2.9339s
<span class="nv">$ </span>./ParallelFastFourierTransform 4 22
Serial Time: 4.26301s
Parallel Time: 1.87973s
<span class="nv">$ </span>./ParallelFastFourierTransform 8 22
Serial Time: 4.27979s
Parallel Time: 1.89624s
</code></pre></div></div>

<p>å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæˆ‘çš„æœºå™¨æ˜¯åŒæ ¸å¿ƒå››çº¿ç¨‹ï¼Œåœ¨å››çº¿ç¨‹å¹¶è¡ŒåŠ é€Ÿæ—¶å¾—åˆ°äº†æœ€ä¼˜çš„åŠ é€Ÿæ¯”ã€‚å››çº¿ç¨‹å¹¶è¡Œä¼˜åŒ–çš„å‚…é‡Œå¶å˜æ¢æ¯”ä¸²è¡Œç‰ˆæœ¬å¿«äº†çº¦56%.</p>

<h3 id="æºä»£ç ">æºä»£ç </h3>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;bits/stdc++.h&gt;
#include &lt;omp.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">double</span> <span class="n">lf</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Rader</span> <span class="o">:</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span>
<span class="p">{</span>
	<span class="n">Rader</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="kt">int</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">n</span><span class="p">))))</span>
	<span class="p">{</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">at</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">at</span><span class="p">(</span><span class="n">i</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+=</span> <span class="n">size</span><span class="p">()</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">FFT</span> <span class="o">:</span> <span class="n">Rader</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
	<span class="n">FFT</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span> <span class="o">:</span> <span class="n">Rader</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">w</span><span class="p">(</span><span class="n">size</span><span class="p">(),</span> <span class="n">polar</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M_PI</span> <span class="o">/</span> <span class="n">size</span><span class="p">()))</span>
	<span class="p">{</span>
		<span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
	<span class="p">}</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">pfft</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
<span class="cp">#pragma omp parallel for
</span>		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">x</span><span class="p">[</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span>
<span class="cp">#pragma omp parallel for
</span>			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">k</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">size</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">];</span>
					<span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">t</span><span class="p">;</span>
				<span class="p">}</span>
		<span class="k">return</span> <span class="n">x</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">fft</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">x</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">x</span><span class="p">[</span><span class="n">at</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">i</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">)</span>
			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
				<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="n">k</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">w</span><span class="p">[</span><span class="n">size</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">];</span>
					<span class="n">x</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">t</span><span class="p">;</span>
				<span class="p">}</span>
		<span class="k">return</span> <span class="n">x</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">ask</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span> <span class="k">const</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">xa</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">a</span><span class="p">.</span><span class="n">end</span><span class="p">()),</span> <span class="n">xb</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">b</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
		<span class="n">xa</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span> <span class="n">xb</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">xb</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">xa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">xb</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">ans</span><span class="p">(</span><span class="n">size</span><span class="p">());</span>
		<span class="n">xa</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">xa</span><span class="p">),</span> <span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">real</span><span class="p">()</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xa</span><span class="p">[</span><span class="n">size</span><span class="p">()</span> <span class="o">-</span> <span class="n">i</span><span class="p">].</span><span class="n">real</span><span class="p">()</span> <span class="o">/</span> <span class="n">size</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"Error: No Enough parameters ("</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">" &lt;num-of-threads&gt; &lt;power-of-transform-length&gt;).</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span>
	<span class="n">omp_set_num_threads</span><span class="p">(</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>
	<span class="n">FFT</span> <span class="n">fft</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]));</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">(</span><span class="n">fft</span><span class="p">.</span><span class="n">begin</span><span class="p">(),</span> <span class="n">fft</span><span class="p">.</span><span class="n">end</span><span class="p">());</span>
	<span class="kt">double</span> <span class="n">t0</span> <span class="o">=</span> <span class="n">omp_get_wtime</span><span class="p">();</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">fft</span><span class="p">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
	<span class="kt">double</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">omp_get_wtime</span><span class="p">();</span>
	<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Serial Time: "</span> <span class="o">&lt;&lt;</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span> <span class="o">&lt;&lt;</span> <span class="s">"s</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">complex</span><span class="o">&lt;</span><span class="n">lf</span><span class="o">&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">fft</span><span class="p">.</span><span class="n">pfft</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
	<span class="kt">double</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">omp_get_wtime</span><span class="p">();</span>
	<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Parallel Time: "</span> <span class="o">&lt;&lt;</span> <span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span> <span class="o">&lt;&lt;</span> <span class="s">"s</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">b</span> <span class="o">!=</span> <span class="n">c</span><span class="p">)</span>
		<span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">"Error: Parallel result are not equivalent to Serial result.</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
:ET