I"ã´<h2 id="magic-mirror"><a href="https://nanti.jisuanke.com/t/31710">Magic Mirror</a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
</span><span class="kt">int</span> <span class="n">T</span><span class="p">;</span>
<span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">=</span><span class="s">"JESSIE"</span><span class="p">,</span><span class="n">b</span><span class="p">[</span><span class="mi">20</span><span class="p">]</span><span class="o">=</span><span class="s">"jessie"</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">o</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">T</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">T</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">!=</span><span class="mi">6</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">"Dare you say that again?</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">o</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;</span><span class="mi">6</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		 <span class="k">if</span> <span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
		 <span class="p">{</span>
		 	<span class="n">o</span><span class="o">=</span><span class="nb">false</span><span class="p">;</span>
		 	<span class="k">break</span><span class="p">;</span>
		 <span class="p">}</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="n">printf</span><span class="p">(</span><span class="s">"Good guy!</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
		 <span class="k">else</span> <span class="n">printf</span><span class="p">(</span><span class="s">"Dare you say that again?</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h2 id="mathematical-curse"><a href="https://nanti.jisuanke.com/t/31711">Mathematical Curse</a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;algorithm&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">a</span><span class="p">[</span><span class="mi">1010</span><span class="p">];</span>
<span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">10</span><span class="p">];</span>
<span class="kt">long</span> <span class="kt">long</span> <span class="n">mx</span><span class="p">[</span><span class="mi">1010</span><span class="p">][</span><span class="mi">10</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="mi">1010</span><span class="p">][</span><span class="mi">10</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">t</span><span class="o">--</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">m</span><span class="p">,</span><span class="o">&amp;</span><span class="n">k</span><span class="p">);</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">scanf</span><span class="p">(</span><span class="s">"%lld"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">mx</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">mx</span><span class="p">));</span>
		<span class="n">memset</span><span class="p">(</span><span class="n">mn</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="n">mn</span><span class="p">));</span>
		<span class="n">mx</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
		 <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">;(</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">)</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="n">j</span><span class="o">&lt;=</span><span class="n">i</span><span class="p">);</span><span class="n">j</span><span class="o">++</span><span class="p">)</span>
		 <span class="p">{</span>
		 	<span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
		  	<span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="sc">'+'</span><span class="p">)</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		   	 <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="sc">'-'</span><span class="p">)</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		      <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="sc">'*'</span><span class="p">)</span>
			  <span class="p">{</span>
			  	<span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			  	 <span class="k">else</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			  <span class="p">}</span>
			   <span class="k">else</span>
			   <span class="p">{</span>
			   	<span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			   	 <span class="k">else</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			   <span class="p">}</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">i</span><span class="o">&gt;</span><span class="n">j</span><span class="p">)</span> <span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">mx</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]),</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">mn</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]);</span>
		 <span class="p">}</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">mx</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">m</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="password"><a href="https://nanti.jisuanke.com/t/31712">Password</a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<h2 id="sequence"><a href="https://nanti.jisuanke.com/t/31713">Sequence</a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<h2 id="jiu-yuan-wants-to-eat"><a href="https://nanti.jisuanke.com/t/31714">Jiu Yuan Wants to Eat</a></h2>

<p>é“¾å‰–+åŒæ ‡è®°ç»´æŠ¤åŒºé—´å’Œï¼ŒåŒºé—´å–åæ“ä½œç­‰ä»·äºåŒºé—´ä¹˜ <code class="highlighter-rouge">-1</code> ååŒºé—´åŠ  <code class="highlighter-rouge">-1</code> ã€‚
æ—¶é™å¡çš„æœ‰ç‚¹ç´§ï¼Œçº¿æ®µæ ‘ç”¨ vector å»ºçš„æ—¶å€™å¡æ—¶é™ 2832ms/3000msï¼Œæ”¹æˆæ•°ç»„ä¹Ÿè¦è·‘ 2448ms/3000msã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;cstdio&gt;
#include&lt;vector&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">SegmentTree</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="nc">Node</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>
		<span class="n">ll</span> <span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">,</span><span class="n">sum</span><span class="p">;</span>
		<span class="kt">void</span> <span class="n">set</span><span class="p">(</span><span class="n">ll</span> <span class="n">m</span><span class="p">,</span><span class="n">ll</span> <span class="n">a</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">mul</span><span class="o">*=</span><span class="n">m</span><span class="p">,</span><span class="n">add</span><span class="o">=</span><span class="n">add</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="n">a</span><span class="p">,</span><span class="n">sum</span><span class="o">=</span><span class="n">sum</span><span class="o">*</span><span class="n">m</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="kt">void</span> <span class="n">up</span><span class="p">(</span><span class="k">const</span> <span class="n">Node</span> <span class="o">&amp;</span><span class="n">lc</span><span class="p">,</span><span class="k">const</span> <span class="n">Node</span> <span class="o">&amp;</span><span class="n">rc</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">sum</span><span class="o">=</span><span class="n">lc</span><span class="p">.</span><span class="n">sum</span><span class="o">+</span><span class="n">rc</span><span class="p">.</span><span class="n">sum</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="kt">void</span> <span class="n">down</span><span class="p">(</span><span class="n">Node</span> <span class="o">&amp;</span><span class="n">lc</span><span class="p">,</span><span class="n">Node</span> <span class="o">&amp;</span><span class="n">rc</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">lc</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">),</span><span class="n">rc</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">),</span><span class="n">mul</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">add</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">};</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span>
	<span class="n">SegmentTree</span><span class="p">(</span><span class="kt">int</span> <span class="n">N</span><span class="p">)</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="n">N</span><span class="o">&lt;&lt;</span><span class="mi">2</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">build</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">rt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">]</span><span class="o">=</span> <span class="p">{</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">};</span>
		<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;=</span><span class="n">r</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">m</span><span class="o">=</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">build</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">),</span><span class="n">build</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">),</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">up</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">set</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="n">ll</span> <span class="n">mul</span><span class="p">,</span><span class="n">ll</span> <span class="n">add</span><span class="p">,</span><span class="kt">int</span> <span class="n">rt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">l</span><span class="o">&amp;&amp;</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">r</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">)</span><span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">set</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">);</span>
		<span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">down</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">]);</span>
		<span class="kt">int</span> <span class="n">m</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">l</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&gt;=</span><span class="n">r</span><span class="p">)</span><span class="n">set</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="n">l</span><span class="p">)</span><span class="n">set</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">else</span> <span class="n">set</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">),</span><span class="n">set</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">);</span>
		<span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">up</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">]);</span>
	<span class="p">}</span>
	<span class="n">Node</span> <span class="n">ask</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">rt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">l</span><span class="o">&amp;&amp;</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">r</span><span class="o">&lt;=</span><span class="n">r</span><span class="p">)</span><span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">];</span>
		<span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">down</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">]);</span>
		<span class="kt">int</span> <span class="n">m</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">l</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">rt</span><span class="p">].</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&gt;=</span><span class="n">r</span><span class="p">)</span><span class="k">return</span> <span class="n">ask</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">m</span><span class="o">&lt;</span><span class="n">l</span><span class="p">)</span><span class="k">return</span> <span class="n">ask</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">up</span><span class="p">(</span><span class="n">ask</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">),</span><span class="n">ask</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">rt</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="o">|</span><span class="mi">1</span><span class="p">)),</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">Graph</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="nc">Vertex</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">o</span><span class="p">,</span><span class="n">i</span><span class="p">;</span><span class="c1">//ç›¸å…³å‡ºè¾¹å’Œå…¥è¾¹ç¼–å·</span>
		<span class="kt">int</span> <span class="n">siz</span><span class="p">,</span><span class="n">dep</span><span class="p">,</span><span class="n">top</span><span class="p">,</span><span class="n">dfn</span><span class="p">;</span><span class="c1">//æ ‘é“¾å‰–åˆ†ä¸­ä½¿ç”¨ï¼Œä¾æ¬¡ä»£è¡¨å­æ ‘èŠ‚ç‚¹æ•°ã€æ·±åº¦ã€æ‰€åœ¨é“¾çš„é¡¶ç«¯èŠ‚ç‚¹ã€dfsåº</span>
	<span class="p">};</span>
	<span class="k">typedef</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">Edge</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Vertex</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span><span class="c1">//ç‚¹é›†</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">;</span><span class="c1">//è¾¹é›†</span>
	<span class="n">Graph</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">ed</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">v</span><span class="p">[</span><span class="n">ed</span><span class="p">.</span><span class="n">first</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="n">v</span><span class="p">[</span><span class="n">ed</span><span class="p">.</span><span class="n">second</span><span class="p">].</span><span class="n">i</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="n">e</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">ch</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">//uçš„ç¬¬iä¸ªå­©å­èŠ‚ç‚¹</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">e</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">second</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">fa</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">//uçš„ç¬¬iä¸ªçˆ¶èŠ‚ç‚¹</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">e</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">i</span><span class="p">[</span><span class="n">i</span><span class="p">]].</span><span class="n">first</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">Diagram</span><span class="o">:</span><span class="n">Graph</span>
<span class="p">{</span>
	<span class="n">SegmentTree</span> <span class="n">data</span><span class="p">;</span>
	<span class="n">Diagram</span><span class="p">(</span><span class="k">const</span> <span class="n">Graph</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span><span class="kt">int</span> <span class="n">root</span><span class="p">)</span><span class="o">:</span>
		<span class="n">Graph</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">()),</span><span class="n">data</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">())</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">cnt</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">root</span><span class="p">].</span><span class="n">dfn</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">root</span><span class="p">].</span><span class="n">dep</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">build</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="n">g</span><span class="p">),</span><span class="n">dfs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">root</span><span class="p">].</span><span class="n">top</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">cnt</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">build</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="k">const</span> <span class="n">Graph</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">)</span><span class="c1">//æ— å‘å›¾dfså»ºæ ‘ï¼Œä¸”é‡è¾¹åœ¨æœ€å‰ï¼Œuä¸ºæ ¹èŠ‚ç‚¹</span>
	<span class="p">{</span>
		<span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">siz</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">to</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">g</span><span class="p">.</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">g</span><span class="p">.</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">to</span><span class="o">=</span><span class="n">g</span><span class="p">.</span><span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">second</span><span class="p">,</span><span class="o">!</span><span class="n">v</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">siz</span><span class="p">)</span><span class="c1">//æ²¡è®¿é—®è¿‡çš„ç‚¹sizé»˜è®¤0</span>
			<span class="p">{</span>
				<span class="n">build</span><span class="p">(</span><span class="n">to</span><span class="p">,</span><span class="n">g</span><span class="p">),</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">siz</span><span class="o">+=</span><span class="n">v</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">siz</span><span class="p">,</span><span class="n">add</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">]);</span>
				<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">ch</span><span class="p">(</span><span class="n">u</span><span class="p">)].</span><span class="n">siz</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">siz</span><span class="p">)</span><span class="c1">//é‡è¾¹ç§»åˆ°æœ€å‰</span>
					<span class="n">swap</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">front</span><span class="p">(),</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">back</span><span class="p">());</span>
			<span class="p">}</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">dfs</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="p">,</span><span class="kt">int</span> <span class="o">&amp;</span><span class="n">cnt</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">to</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">o</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">v</span><span class="p">[</span><span class="n">to</span><span class="o">=</span><span class="n">ch</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">i</span><span class="p">)].</span><span class="n">dep</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">dep</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
			<span class="n">v</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">top</span><span class="o">=</span><span class="n">i</span><span class="o">?</span><span class="n">to</span><span class="o">:</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">top</span><span class="p">;</span>
			<span class="n">v</span><span class="p">[</span><span class="n">to</span><span class="p">].</span><span class="n">dfn</span><span class="o">=++</span><span class="n">cnt</span><span class="p">;</span>
			<span class="n">dfs</span><span class="p">(</span><span class="n">to</span><span class="p">,</span><span class="n">cnt</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">set</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">,</span><span class="n">ll</span> <span class="n">mul</span><span class="p">,</span><span class="n">ll</span> <span class="n">add</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(;</span> <span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="o">!=</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">top</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="n">fa</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="p">))</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="p">].</span><span class="n">dep</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">top</span><span class="p">].</span><span class="n">dep</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
			<span class="n">data</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="p">].</span><span class="n">dfn</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">dfn</span><span class="p">,</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">dep</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">dep</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
		<span class="n">data</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">dfn</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">dfn</span><span class="p">,</span><span class="n">mul</span><span class="p">,</span><span class="n">add</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">SegmentTree</span><span class="o">::</span><span class="n">Node</span> <span class="n">ask</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span><span class="kt">int</span> <span class="n">y</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">SegmentTree</span><span class="o">::</span><span class="n">Node</span> <span class="n">ans</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="n">ans</span><span class="p">.</span><span class="n">sum</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="o">!=</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">top</span><span class="p">;</span> <span class="n">x</span><span class="o">=</span><span class="n">fa</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="p">))</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="p">].</span><span class="n">dep</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">top</span><span class="p">].</span><span class="n">dep</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
			<span class="n">ans</span><span class="p">.</span><span class="n">up</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">data</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">top</span><span class="p">].</span><span class="n">dfn</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">dfn</span><span class="p">));</span>
		<span class="p">}</span>
		<span class="k">if</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">dep</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">dep</span><span class="p">)</span><span class="n">swap</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">ans</span><span class="p">.</span><span class="n">up</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span><span class="n">data</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">y</span><span class="p">].</span><span class="n">dfn</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">x</span><span class="p">].</span><span class="n">dfn</span><span class="p">)),</span><span class="n">ans</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">;</span> <span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);)</span>
	<span class="p">{</span>
		<span class="n">Graph</span> <span class="n">g</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">b</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">b</span><span class="p">),</span><span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="n">b</span><span class="p">,</span><span class="n">i</span><span class="p">});</span>
		<span class="n">Diagram</span> <span class="n">d</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">ll</span> <span class="n">x</span><span class="p">;</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%llu%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span><span class="o">&amp;</span><span class="n">u</span><span class="p">,</span><span class="o">&amp;</span><span class="n">v</span><span class="p">);</span>
			<span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%llu"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">x</span><span class="p">),</span><span class="n">d</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%llu"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">x</span><span class="p">),</span><span class="n">d</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">);</span>
			<span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="n">d</span><span class="p">.</span><span class="n">set</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
			<span class="k">else</span> <span class="n">printf</span><span class="p">(</span><span class="s">"%llu</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">d</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">).</span><span class="n">sum</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="modular-production-line"><a href="https://nanti.jisuanke.com/t/31715">Modular Production Line</a></h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;cstdio&gt;
#include&lt;queue&gt;
#include&lt;algorithm&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">N</span><span class="o">=</span><span class="mi">100009</span><span class="p">,</span><span class="n">NPOS</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">INF</span><span class="o">=</span><span class="mf">1e18</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Ranker</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span>
<span class="p">{</span>
	<span class="kt">void</span> <span class="n">init</span><span class="p">()</span>
	<span class="p">{</span>
		<span class="n">sort</span><span class="p">(</span><span class="n">begin</span><span class="p">(),</span><span class="n">end</span><span class="p">()),</span><span class="n">resize</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">begin</span><span class="p">(),</span><span class="n">end</span><span class="p">())</span><span class="o">-</span><span class="n">begin</span><span class="p">());</span>
	<span class="p">}</span>
	<span class="kt">int</span> <span class="n">ask</span><span class="p">(</span><span class="n">ll</span> <span class="n">x</span><span class="p">)</span><span class="k">const</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">lower_bound</span><span class="p">(</span><span class="n">begin</span><span class="p">(),</span><span class="n">end</span><span class="p">(),</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">begin</span><span class="p">();</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">Graph</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="nc">Vertex</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">a</span><span class="cm">/*,b*/</span><span class="p">;</span><span class="c1">//ç›¸å…³å‡ºè¾¹å’Œå…¥è¾¹ç¼–å·</span>
		<span class="c1">//int siz,dep,top,dfn;//æ ‘é“¾å‰–åˆ†ä¸­ä½¿ç”¨ï¼Œä¾æ¬¡ä»£è¡¨å­æ ‘èŠ‚ç‚¹æ•°ã€æ·±åº¦ã€æ‰€åœ¨é“¾çš„é¡¶ç«¯èŠ‚ç‚¹ã€dfsåº</span>
	<span class="p">};</span>
	<span class="k">struct</span> <span class="nc">Edge</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">from</span><span class="p">,</span><span class="n">to</span><span class="p">;</span>
		<span class="n">ll</span> <span class="n">dist</span><span class="p">,</span><span class="n">cap</span><span class="p">;</span><span class="c1">//è¾¹é•¿ã€å®¹é‡ï¼Œå›¾è®ºç®—æ³•ä½¿ç”¨</span>
	<span class="p">};</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Vertex</span><span class="o">&gt;</span> <span class="n">v</span><span class="p">;</span><span class="c1">//ç‚¹é›†</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">Edge</span><span class="o">&gt;</span> <span class="n">e</span><span class="p">;</span><span class="c1">//è¾¹é›†</span>
	<span class="n">Graph</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span><span class="n">v</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="k">const</span> <span class="n">Edge</span> <span class="o">&amp;</span><span class="n">ed</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">ed</span><span class="p">.</span><span class="n">from</span><span class="o">==</span><span class="n">ed</span><span class="p">.</span><span class="n">to</span><span class="p">)</span><span class="k">return</span><span class="p">;</span><span class="c1">//å¦‚æœæœ‰éœ€è¦è¯·æ‹†ç‚¹</span>
		<span class="n">v</span><span class="p">[</span><span class="n">ed</span><span class="p">.</span><span class="n">from</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="c1">//v[ed.to].b.push_back(e.size());</span>
		<span class="n">e</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">EdmondKarp</span><span class="o">:</span><span class="n">Graph</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">flow</span><span class="p">,</span><span class="n">cost</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">f</span><span class="p">;</span>
	<span class="n">EdmondKarp</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span><span class="n">Graph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">{}</span>
	<span class="kt">void</span> <span class="n">add</span><span class="p">(</span><span class="n">Edge</span> <span class="n">ed</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Graph</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
		<span class="n">swap</span><span class="p">(</span><span class="n">ed</span><span class="p">.</span><span class="n">from</span><span class="p">,</span><span class="n">ed</span><span class="p">.</span><span class="n">to</span><span class="p">),</span><span class="n">ed</span><span class="p">.</span><span class="n">cap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ed</span><span class="p">.</span><span class="n">dist</span><span class="o">*=-</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">Graph</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">ed</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="kt">void</span> <span class="n">ask</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">t</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">p</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="n">NPOS</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="n">flow</span><span class="o">=</span><span class="n">cost</span><span class="o">=</span><span class="mi">0</span><span class="p">);;)</span>
		<span class="p">{</span>
			<span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="n">INF</span><span class="p">);</span>
			<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">flag</span><span class="p">(</span><span class="n">v</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">deque</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">q</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">s</span><span class="p">);</span> <span class="o">!</span><span class="n">q</span><span class="p">.</span><span class="n">empty</span><span class="p">();</span> <span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">())</span>
				<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">=</span><span class="n">q</span><span class="p">.</span><span class="n">front</span><span class="p">(),</span><span class="n">i</span><span class="o">=</span><span class="n">flag</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">to</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
					<span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="n">v</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">to</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">to</span><span class="p">,</span>
					        <span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">cap</span><span class="o">&gt;</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">&amp;&amp;</span><span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span><span class="o">&gt;</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">dist</span><span class="p">)</span>
					<span class="p">{</span>
						<span class="n">d</span><span class="p">[</span><span class="n">to</span><span class="p">]</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">+</span><span class="n">e</span><span class="p">[</span><span class="n">k</span><span class="p">].</span><span class="n">dist</span><span class="p">,</span><span class="n">p</span><span class="p">[</span><span class="n">to</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
						<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">flag</span><span class="p">[</span><span class="n">to</span><span class="p">])</span><span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">to</span><span class="p">),</span><span class="n">flag</span><span class="p">[</span><span class="n">to</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
					<span class="p">}</span>
			<span class="k">if</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span><span class="o">==</span><span class="n">INF</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
			<span class="n">ll</span> <span class="n">_f</span><span class="o">=</span><span class="n">INF</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">=</span><span class="n">t</span><span class="p">;</span> <span class="n">u</span><span class="o">!=</span><span class="n">s</span><span class="p">;</span> <span class="n">u</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">from</span><span class="p">)</span>
				<span class="n">_f</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">_f</span><span class="p">,</span><span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">cap</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]]);</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">u</span><span class="o">=</span><span class="n">t</span><span class="p">;</span> <span class="n">u</span><span class="o">!=</span><span class="n">s</span><span class="p">;</span> <span class="n">u</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">from</span><span class="p">)</span>
				<span class="n">cost</span><span class="o">+=</span><span class="n">_f</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]].</span><span class="n">dist</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]]</span><span class="o">+=</span><span class="n">_f</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">^</span><span class="mi">1</span><span class="p">]</span><span class="o">-=</span><span class="n">_f</span><span class="p">;</span>
			<span class="n">flow</span><span class="o">+=</span><span class="n">_f</span><span class="p">;</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">w</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span> <span class="n">t</span><span class="o">--</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="n">Ranker</span> <span class="n">rk</span><span class="p">;</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">k</span><span class="p">,</span><span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="o">&amp;</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="o">&amp;</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
			<span class="n">rk</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
			<span class="n">rk</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="o">++</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
		<span class="p">}</span>
		<span class="n">rk</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
		<span class="n">EdmondKarp</span> <span class="n">g</span><span class="p">(</span><span class="n">rk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="mi">2</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">rk</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">});</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="n">rk</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="n">rk</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="o">-</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">1</span><span class="p">});</span>
		<span class="n">g</span><span class="p">.</span><span class="n">add</span><span class="p">({</span><span class="n">rk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">});</span>
		<span class="n">g</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">rk</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">rk</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="o">-</span><span class="n">g</span><span class="p">.</span><span class="n">cost</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="give-candies"><a href="https://nanti.jisuanke.com/t/31716">Give Candies</a></h2>

<p>ç­”æ¡ˆæ˜¯$2^{n-2}$ï¼Œç”¨è´¹é©¬å°å®šç†æŠŠæŒ‡æ•°å¯¹ M-1 å–æ¨¡åè¿›è¡Œè¿ç®—é¿å…æ›´å¤šçš„é«˜ç²¾åº¦è¿ç®—ã€‚</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt;
#define mul(a,b,c) (1LL*(a)*(b)%(c))
</span><span class="k">typedef</span> <span class="kt">int</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">M</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>
<span class="n">ll</span> <span class="nf">pow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">,</span><span class="n">ll</span> <span class="n">m</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">a</span><span class="o">%=</span><span class="n">m</span><span class="p">;</span> <span class="n">b</span><span class="p">;</span> <span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
		<span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">r</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">100009</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span> <span class="n">t</span><span class="o">--</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">];</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">n</span><span class="o">=</span><span class="n">mul</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">M</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="sc">'0'</span><span class="p">;</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="n">M</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">M</span><span class="p">));</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="string-and-times"><a href="https://nanti.jisuanke.com/t/31717">String and Times</a></h2>

<p>æ‹‰ä¸€ä¸ªåç¼€æ•°ç»„çš„æ¿å­è·‘æ‰äº†ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;cstdio&gt;
#include&lt;cstring&gt;
#include&lt;cmath&gt;
#include&lt;vector&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">SufArr</span>
<span class="p">{</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">sa</span><span class="p">,</span><span class="n">rk</span><span class="p">,</span><span class="n">h</span><span class="p">;</span>
	<span class="n">SufArr</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">,</span><span class="kt">int</span> <span class="n">m</span><span class="p">)</span><span class="o">:</span><span class="n">sa</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="mi">0</span><span class="p">),</span><span class="n">rk</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">h</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">cnt</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="n">m</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="o">++</span><span class="n">cnt</span><span class="p">[</span><span class="n">rk</span><span class="p">[</span><span class="n">i</span><span class="p">]];</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">sa</span><span class="p">[</span><span class="o">--</span><span class="n">cnt</span><span class="p">[</span><span class="n">rk</span><span class="p">[</span><span class="n">i</span><span class="p">]]]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;=</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="n">j</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;&lt;=</span><span class="mi">1</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="n">j</span><span class="o">+=</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
				<span class="n">h</span><span class="p">[</span><span class="n">cnt</span><span class="p">[</span><span class="n">rk</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span><span class="o">++</span><span class="p">]</span><span class="o">=</span><span class="n">j</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">cnt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">sa</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">=</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">rk</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">!=</span><span class="n">rk</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">||</span><span class="n">rk</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">!=</span><span class="n">rk</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">])</span>
					<span class="n">cnt</span><span class="p">[</span><span class="o">++</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
				<span class="n">sa</span><span class="p">[</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="n">j</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">swap</span><span class="p">(</span><span class="n">rk</span><span class="p">,</span><span class="n">sa</span><span class="p">),</span><span class="n">swap</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="n">h</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="n">rk</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">,</span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(;</span> <span class="o">~</span><span class="n">k</span><span class="o">&amp;&amp;</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">s</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">];</span> <span class="n">j</span><span class="o">=</span><span class="n">rk</span><span class="p">[</span><span class="n">sa</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="o">--</span><span class="n">k</span><span class="p">)</span>
				<span class="n">h</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="k">struct</span> <span class="nc">SparseTable</span>
<span class="p">{</span>
	<span class="k">typedef</span> <span class="kt">int</span> <span class="n">ll</span><span class="p">;</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="n">f</span><span class="p">;</span>
	<span class="n">SparseTable</span><span class="p">(</span><span class="k">const</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ll</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">)</span><span class="o">:</span><span class="n">f</span><span class="p">(</span><span class="n">log2</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">f</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)</span><span class="o">&lt;</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
				<span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">min</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)]);</span>
	<span class="p">}</span>
	<span class="n">ll</span> <span class="n">ask</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="n">log2</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
		<span class="k">return</span> <span class="n">min</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">k</span><span class="p">)]);</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="n">ll</span> <span class="nf">cal</span><span class="p">(</span><span class="n">SufArr</span> <span class="o">&amp;</span><span class="n">sa</span><span class="p">,</span><span class="n">SparseTable</span> <span class="o">&amp;</span><span class="n">st</span><span class="p">,</span><span class="kt">int</span> <span class="n">k</span><span class="p">)</span><span class="c1">//åŸä¸²ä¸­è‡³å°‘å‡ºç°kæ¬¡çš„å­ä¸²æ•°é‡</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
	<span class="k">if</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">k</span><span class="p">;</span> <span class="n">r</span><span class="o">&lt;</span><span class="n">sa</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">l</span><span class="p">,</span><span class="o">++</span><span class="n">r</span><span class="p">)</span>
			<span class="n">ans</span><span class="o">+=</span><span class="n">max</span><span class="p">(</span><span class="n">st</span><span class="p">.</span><span class="n">ask</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">)</span><span class="o">-</span><span class="n">sa</span><span class="p">.</span><span class="n">h</span><span class="p">[</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">);</span>
	<span class="k">else</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">sa</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="n">ans</span><span class="o">+=</span><span class="n">sa</span><span class="p">.</span><span class="n">h</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">sa</span><span class="p">.</span><span class="n">sa</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">sa</span><span class="p">.</span><span class="n">h</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
	<span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">2000009</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">;</span> <span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%s%d%d"</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="o">&amp;</span><span class="n">b</span><span class="p">);)</span>
	<span class="p">{</span>
		<span class="n">SufArr</span> <span class="n">sa</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="o">+</span><span class="n">strlen</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="sc">'Z'</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
		<span class="n">SparseTable</span> <span class="n">st</span><span class="p">(</span><span class="n">sa</span><span class="p">.</span><span class="n">h</span><span class="p">);</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">cal</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="n">cal</span><span class="p">(</span><span class="n">sa</span><span class="p">,</span><span class="n">st</span><span class="p">,</span><span class="n">b</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span>
	<span class="p">}</span>
<span class="p">}</span>

</code></pre></div></div>

<h2 id="save-the-room"><a href="https://nanti.jisuanke.com/t/31718">Save the Room</a></h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt;
</span><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">;</span> <span class="o">~</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="o">&amp;</span><span class="n">c</span><span class="p">);)</span>
		<span class="n">printf</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="o">&amp;&amp;</span><span class="n">b</span><span class="o">%</span><span class="mi">2</span><span class="o">&amp;&amp;</span><span class="n">c</span><span class="o">%</span><span class="mi">2</span><span class="o">?</span><span class="s">"No</span><span class="se">\n</span><span class="s">"</span><span class="o">:</span><span class="s">"Yes</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="participate-in-e-sports"><a href="https://nanti.jisuanke.com/t/31719">Participate in E-sports</a></h2>

<p>äº¤äº†ä¸ªé«˜ç²¾åº¦å¼€æ ¹å·ä¸Šå»ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;cmath&gt;
#include&lt;iostream&gt;
#include&lt;vector&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Wint</span><span class="o">:</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="c1">//ç»§æ‰¿vector</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">width</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">base</span><span class="o">=</span><span class="mf">1e9</span><span class="p">;</span>
	<span class="n">Wint</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">//æ™®é€šåˆå§‹åŒ–ï¼Œå½“æ•´å‹æ•°å’ŒWintåŒæ—¶è¿ç®—æ—¶ä¼šæå‡è‡³Wint</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(;</span> <span class="n">n</span><span class="p">;</span> <span class="n">n</span><span class="o">/=</span><span class="n">base</span><span class="p">)</span><span class="n">push_back</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="n">base</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">explicit</span> <span class="n">Wint</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span> <span class="o">&amp;</span><span class="n">s</span><span class="p">)</span><span class="c1">//å­—ç¬¦ä¸²åˆå§‹åŒ–å‡½æ•°ï¼Œæœªåˆ¤æ–­å­—ç¬¦ä¸²åˆæ³•æƒ…å†µ</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="o">=</span><span class="kt">int</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">width</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">len</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="n">e</span><span class="o">=</span><span class="n">s</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="n">i</span><span class="o">*</span><span class="n">width</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">e</span><span class="o">-</span><span class="n">width</span><span class="p">),</span><span class="n">push_back</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">b</span><span class="o">!=</span><span class="n">e</span><span class="p">;</span> <span class="o">++</span><span class="n">b</span><span class="p">)</span>
				<span class="n">back</span><span class="p">()</span><span class="o">=</span><span class="n">back</span><span class="p">()</span><span class="o">*</span><span class="mi">10</span><span class="o">+</span><span class="n">s</span><span class="p">[</span><span class="n">b</span><span class="p">]</span><span class="o">-</span><span class="sc">'0'</span><span class="p">;</span>
		<span class="n">trim</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="n">trim</span><span class="p">(</span><span class="kt">bool</span> <span class="n">up</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">//å»å‰å¯¼0ï¼Œæ˜¯å¦éœ€è¦è¿›ä½ï¼Œå¾ˆå¸¸ç”¨çš„å°å‡½æ•°ï¼Œä¸ºæ–¹ä¾¿è¿”å›è‡ªèº«</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">up</span><span class="o">&amp;&amp;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">if</span><span class="p">((</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">--</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">],(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">base</span><span class="p">;</span>
			<span class="k">if</span><span class="p">((</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">base</span><span class="p">)(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">base</span><span class="p">,(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">%=</span><span class="n">base</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">empty</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="n">back</span><span class="p">()</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">)</span><span class="n">pop_back</span><span class="p">();</span>
		<span class="k">for</span><span class="p">(;</span> <span class="n">up</span><span class="o">&amp;&amp;!</span><span class="n">empty</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="n">back</span><span class="p">()</span><span class="o">&gt;=</span><span class="n">base</span><span class="p">;</span> <span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">%=</span><span class="n">base</span><span class="p">)</span>
			<span class="n">push_back</span><span class="p">(</span><span class="n">back</span><span class="p">()</span><span class="o">/</span><span class="n">base</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">istream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="n">istream</span> <span class="o">&amp;</span><span class="n">is</span><span class="p">,</span><span class="n">Wint</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">string</span> <span class="n">s</span><span class="p">;</span><span class="c1">//æ‡’</span>
		<span class="k">return</span> <span class="n">is</span><span class="o">&gt;&gt;</span><span class="n">s</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">Wint</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">is</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ostream</span> <span class="o">&amp;</span><span class="n">os</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">n</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">empty</span><span class="p">())</span><span class="k">return</span> <span class="n">os</span><span class="p">.</span><span class="n">put</span><span class="p">(</span><span class="sc">'0'</span><span class="p">);</span>
		<span class="n">os</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">.</span><span class="n">back</span><span class="p">();</span>
		<span class="kt">char</span> <span class="n">ch</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">fill</span><span class="p">(</span><span class="sc">'0'</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">2</span><span class="p">;</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="n">width</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">width</span><span class="p">),</span><span class="n">os</span><span class="o">&lt;&lt;</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">return</span> <span class="n">os</span><span class="p">.</span><span class="n">fill</span><span class="p">(</span><span class="n">ch</span><span class="p">),</span><span class="n">os</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">!=</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="k">return</span> <span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&gt;</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">b</span><span class="o">&lt;</span><span class="n">a</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;=</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="n">b</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="kt">bool</span> <span class="k">operator</span><span class="o">&gt;=</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="o">!</span><span class="p">(</span><span class="n">a</span><span class="o">&lt;</span><span class="n">b</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">+=</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="n">resize</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="c1">//ä¿è¯æœ‰è¶³å¤Ÿçš„ä½æ•°</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">return</span> <span class="n">trim</span><span class="p">();</span><span class="c1">//å•ç‹¬è¿›ä½é˜²è‡ªè¿ç®—</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">Wint</span> <span class="k">operator</span><span class="o">+</span><span class="p">(</span><span class="n">Wint</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="o">+=</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">++</span><span class="p">()</span><span class="c1">//å‰ç½®ç‰ˆæœ¬</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="o">+=</span><span class="mi">1</span><span class="p">;</span><span class="c1">//æ‡’</span>
	<span class="p">}</span>
	<span class="n">Wint</span> <span class="k">operator</span><span class="o">++</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="c1">//åç½®ç‰ˆæœ¬</span>
	<span class="p">{</span>
		<span class="n">Wint</span> <span class="n">b</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">++*</span><span class="k">this</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">-=</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="c1">//a&lt;bä¼šä½¿aå˜ä¸º0</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">())</span><span class="n">resize</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">());</span><span class="c1">//ä¿è¯æœ‰è¶³å¤Ÿçš„ä½æ•°</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
		<span class="k">return</span> <span class="n">trim</span><span class="p">();</span><span class="c1">//å•ç‹¬è¿›ä½é˜²è‡ªè¿ç®—</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">Wint</span> <span class="k">operator</span><span class="o">-</span><span class="p">(</span><span class="n">Wint</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="o">-=</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">--</span><span class="p">()</span><span class="c1">//å‰ç½®ç‰ˆæœ¬</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="o">-=</span><span class="mi">1</span><span class="p">;</span><span class="c1">//æ‡’</span>
	<span class="p">}</span>
	<span class="n">Wint</span> <span class="k">operator</span><span class="o">--</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="c1">//åç½®ç‰ˆæœ¬</span>
	<span class="p">{</span>
		<span class="n">Wint</span> <span class="n">b</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">);</span>
		<span class="k">return</span> <span class="o">--*</span><span class="k">this</span><span class="p">,</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">*=</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="c1">//é«˜ç²¾åº¦ä¹˜æ³•ï¼Œå¸¸è§„å†™æ³•</span>
	<span class="p">{</span>
		<span class="n">Wint</span> <span class="n">c</span><span class="p">;</span>
		<span class="n">c</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="c1">//ç¨€ç–ä¼˜åŒ–ï¼Œç‰¹æ®Šæƒ…å†µå¾ˆæœ‰æ•ˆ</span>
				<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
				<span class="p">{</span>
					<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">];</span>
					<span class="k">for</span><span class="p">(</span><span class="n">n</span><span class="o">*=</span><span class="n">b</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">k</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">;</span> <span class="n">n</span><span class="p">;</span> <span class="n">n</span><span class="o">/=</span><span class="n">base</span><span class="p">)</span>
						<span class="n">c</span><span class="p">[</span><span class="n">k</span><span class="o">++</span><span class="p">]</span><span class="o">+=</span><span class="n">n</span><span class="o">%</span><span class="n">base</span><span class="p">;</span>
					<span class="k">for</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">;</span> <span class="n">c</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">base</span><span class="o">||</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">k</span><span class="p">;</span> <span class="n">c</span><span class="p">[</span><span class="n">l</span><span class="o">++</span><span class="p">]</span><span class="o">%=</span><span class="n">base</span><span class="p">)</span>
						<span class="n">c</span><span class="p">[</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="n">c</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">/</span><span class="n">base</span><span class="p">;</span>
				<span class="p">}</span>
		<span class="k">return</span> <span class="n">swap</span><span class="p">(</span><span class="n">c</span><span class="p">),</span><span class="n">trim</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="cm">/*
	Wint&amp; operator*=(const Wint &amp;b)//ä¸€ç§æ•ˆç‡ç•¥é«˜ä½†å¯¹ä½å®½æœ‰é™åˆ¶çš„å†™æ³•
	{
		vector&lt;unsigned long long&gt; n(size()+b.size(),0);//é˜²çˆ†int
		//ä¹˜æ³•ç®—å®Œåç»Ÿä¸€è¿›ä½æ•ˆç‡é«˜ï¼Œé˜²æ­¢ä¹˜æ³•æº¢å‡ºï¼ˆunsigned long longèŒƒå›´0~1.8e19ï¼‰
		//ä½å®½ä¸º9æ—¶size()ä¸èƒ½è¶…è¿‡18ï¼ˆåè¿›åˆ¶162ä½ï¼‰ï¼Œä½å®½ä¸º8æ—¶size()ä¸èƒ½è¶…è¿‡1800ï¼ˆåè¿›åˆ¶14400ä½ï¼‰ç­‰ç­‰ã€‚
		for(int j=0; j!=b.size(); ++j)
			if(b[j])//ç¨€ç–ä¼˜åŒ–ï¼Œç‰¹æ®Šæƒ…å†µå¾ˆæœ‰æ•ˆ
				for(int i=0; i!=size(); ++i)
					n[i+j]+=(unsigned long long)(*this)[i]*b[j];
		for(int i=1; i&lt;n.size(); ++i)//è¿™é‡Œç”¨&lt;é˜²æ­¢ä½æ•°0ï¼Œå•ç‹¬è¿›ä½é˜²è‡ªè¿ç®—
			n[i]+=n[i-1]/base,n[i-1]%=base;
		return assign(n.begin(),n.end()),trim(0);
	}
	Wint&amp; operator*=(const Wint &amp;b)//fftä¼˜åŒ–ä¹˜æ³•ï¼Œæ³¨æ„doubleä»…15ä½æœ‰æ•ˆæ•°å­—ï¼Œè°ƒå°Wint::widthä¸è¶…è¿‡2ï¼Œè®¡ç®—è‡ª2*log2(base)+2*log2(len)&lt;53
	{
	    vector&lt;ll&gt; ax(begin(),end()),bx(b.begin(),b.end());
	    ax=FFT(size()+b.size()).ask(ax,bx);
	    for(int i=1; i&lt;ax.size(); ++i)
	        ax[i]+=ax[i-1]/base,ax[i-1]%=base;
	    return assign(ax.begin(),ax.end()),trim(0);
	}
	Wint&amp; operator*=(const Wint &amp;b)//nttä¼˜åŒ–ï¼ŒWint::widthä¸è¶…è¿‡2
	{
	    vector&lt;ll&gt; ax(begin(),end()),bx(b.begin(),b.end());
	    ax=FNTT(size()+b.size(),(7&lt;&lt;26)+1,3).ask(ax,bx);
	    for(int i=1; i&lt;ax.size(); ++i)
	        ax[i]+=ax[i-1]/base,ax[i-1]%=base;
	    return assign(ax.begin(),ax.end()),trim(0);
	}
	*/</span>
	<span class="k">friend</span> <span class="n">Wint</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="n">Wint</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="o">*=</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">/=</span><span class="p">(</span><span class="n">Wint</span> <span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Wint</span> <span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">base</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">back</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
		<span class="o">*</span><span class="k">this</span><span class="o">*=</span><span class="n">d</span><span class="p">,</span><span class="n">b</span><span class="o">*=</span><span class="n">d</span><span class="p">,</span><span class="n">c</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">size</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">r</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">begin</span><span class="p">(),(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]);</span>
			<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;=</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">--</span><span class="n">j</span><span class="p">)</span><span class="c1">//b.size()==0è‚¯å®šç¬¬ä¸€è¡Œå°±å‡ºé—®é¢˜çš„</span>
				<span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">base</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">&lt;</span><span class="n">r</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">?</span><span class="n">r</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">:</span><span class="mi">0</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">s</span><span class="o">/</span><span class="n">b</span><span class="p">.</span><span class="n">back</span><span class="p">(),</span><span class="n">d</span><span class="o">*=</span><span class="n">b</span><span class="p">;</span> <span class="n">r</span><span class="o">&lt;</span><span class="n">d</span><span class="p">;</span> <span class="n">r</span><span class="o">+=</span><span class="n">b</span><span class="p">)</span><span class="o">--</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">r</span><span class="o">-=</span><span class="n">d</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">swap</span><span class="p">(</span><span class="n">c</span><span class="p">),</span><span class="n">trim</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="c1">//rä¸ºåŠ å€åçš„ä½™æ•°ï¼Œå¯é€šè¿‡é«˜ç²¾åº¦é™¤ä½ç²¾åº¦å¾—åˆ°çœŸæ­£ä½™æ•°ï¼Œæ­¤å¤„ç•¥</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">Wint</span> <span class="k">operator</span><span class="o">/</span><span class="p">(</span><span class="n">Wint</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="o">/=</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="k">operator</span><span class="o">%=</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="o">-=*</span><span class="k">this</span><span class="o">/</span><span class="n">b</span><span class="o">*</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">Wint</span> <span class="k">operator</span><span class="o">%</span><span class="p">(</span><span class="n">Wint</span> <span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="o">%=</span><span class="n">b</span><span class="p">;</span>
	<span class="p">}</span>
<span class="c1">//å¼€å¹³æ–¹ï¼Œæ”¹è‡ªZJUæ¨¡æ¿</span>
	<span class="kt">bool</span> <span class="n">cmp</span><span class="p">(</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">c</span><span class="p">,</span><span class="kt">int</span> <span class="n">d</span><span class="p">,</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span><span class="k">const</span>
	<span class="p">{</span>
		<span class="k">if</span><span class="p">((</span><span class="kt">int</span><span class="p">)</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="n">c</span><span class="p">)</span><span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
		<span class="kt">long</span> <span class="kt">long</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">lo</span><span class="o">=-</span><span class="p">(</span><span class="n">base</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">);</span> <span class="n">lo</span><span class="o">&lt;=</span><span class="n">t</span><span class="o">&amp;&amp;</span><span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="o">&amp;&amp;~</span><span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
			<span class="k">if</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="o">*</span><span class="n">base</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">0</span><span class="o">&lt;=</span><span class="n">i</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="o">&amp;&amp;</span><span class="n">i</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">size</span><span class="p">())</span>
				<span class="n">t</span><span class="o">+=</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">c</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">t</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">Wint</span><span class="o">&amp;</span> <span class="n">sub</span><span class="p">(</span><span class="k">const</span> <span class="n">Wint</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">,</span><span class="kt">long</span> <span class="kt">long</span> <span class="n">k</span><span class="p">,</span><span class="kt">int</span> <span class="n">d</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="kt">int</span> <span class="n">l</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="n">d</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">d</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">l</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="kt">long</span> <span class="kt">long</span> <span class="n">tmp</span><span class="o">=</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">d</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
			<span class="k">if</span><span class="p">(</span><span class="n">tmp</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="n">tmp</span><span class="o">-</span><span class="n">base</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">base</span><span class="p">;</span>
				<span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="o">-</span><span class="p">(</span><span class="n">tmp</span><span class="o">-</span><span class="n">base</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">base</span><span class="o">*</span><span class="n">base</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="k">else</span> <span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">tmp</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">l</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">size</span><span class="p">()</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="p">((</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">base</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">base</span><span class="p">;</span>
			<span class="p">(</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="p">((</span><span class="o">*</span><span class="k">this</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">base</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">base</span><span class="o">*</span><span class="n">base</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">return</span> <span class="n">trim</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="k">friend</span> <span class="n">Wint</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">Wint</span> <span class="n">a</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">Wint</span> <span class="n">n</span><span class="p">;</span>
		<span class="n">n</span><span class="p">.</span><span class="n">assign</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">n</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span> <span class="o">~</span><span class="n">i</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="k">for</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">r</span><span class="o">=</span><span class="n">a</span><span class="p">.</span><span class="n">base</span><span class="p">,</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span> <span class="n">r</span><span class="o">-</span><span class="n">l</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">;</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">)</span>
			<span class="p">{</span>
				<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="p">.</span><span class="n">cmp</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">))</span><span class="n">r</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
				<span class="k">else</span> <span class="n">l</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="p">}</span>
			<span class="n">a</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">n</span><span class="p">.</span><span class="n">trim</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="cm">/*
	friend Wint sqrt(const Wint &amp;a)//å¸¸è§„ç‰›é¡¿è¿­ä»£å®ç°çš„å¼€å¹³æ–¹ç®—æ³•ï¼Œæ…¢ä½†æ˜¯å¥½æ•²
	{
	    Wint b=a,c=(b+1)/2;
	    while(b!=c)swap(b,c),c=(b+a/b)/2;
	    return c;
	}
	friend Wint sqrt(const Wint &amp;a)
	{
	    Wint ret,t;
	    ret.assign((a.size()+1)&gt;&gt;1,0);
	    for(int i=ret.size()-1,l,r; ~i; --i)
	    {
	        for(l=0,r=a.base; r-l&gt;1;)
	        {
	            ret[i]=l+(r-l)/2;
	            t=ret*ret;
	            if(a&lt;t)r=ret[i];
	            else l=ret[i];
	        }
	        if(!l&amp;&amp;i==ret.size()-1)ret.pop_back();
	        else ret[i]=l;
	    }
	    return ret;
	}
	*/</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">check</span><span class="p">(</span><span class="n">Wint</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Wint</span> <span class="n">sn</span><span class="o">=</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
	<span class="k">return</span> <span class="n">sn</span><span class="o">*</span><span class="n">sn</span><span class="o">==</span><span class="n">n</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">t</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">t</span><span class="p">;</span> <span class="n">t</span><span class="o">--</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="n">Wint</span> <span class="n">n</span><span class="p">;</span>
		<span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span>
		<span class="kt">int</span> <span class="n">ans</span><span class="o">=</span><span class="n">check</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="n">check</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span>
		<span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ans</span><span class="o">==</span><span class="mi">0</span><span class="o">?</span><span class="s">"League of Legends</span><span class="se">\n</span><span class="s">"</span><span class="o">:</span>
		       <span class="n">ans</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="s">"Clash Royale</span><span class="se">\n</span><span class="s">"</span><span class="o">:</span>
		       <span class="n">ans</span><span class="o">==</span><span class="mi">2</span><span class="o">?</span><span class="s">"Hearth Stone</span><span class="se">\n</span><span class="s">"</span><span class="o">:</span>
		       <span class="s">"Arena of Valor</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="transport-ship"><a href="https://nanti.jisuanke.com/t/31720">Transport Ship</a></h2>

<p>æ‹†æˆ 01 èƒŒåŒ…ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
</span><span class="k">const</span> <span class="kt">int</span> <span class="n">N</span><span class="o">=</span><span class="mi">511</span><span class="p">,</span><span class="n">S</span><span class="o">=</span><span class="mi">32767</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">v</span><span class="p">[</span><span class="n">N</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">S</span><span class="p">];</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="k">for</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span> <span class="n">t</span><span class="o">--</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">q</span><span class="p">);</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">C</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">V</span><span class="p">,</span><span class="o">&amp;</span><span class="n">C</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">C</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
				<span class="n">v</span><span class="p">[</span><span class="o">++</span><span class="n">m</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">V</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">s</span><span class="o">&lt;</span><span class="n">S</span><span class="p">;</span> <span class="o">++</span><span class="n">s</span><span class="p">)</span>
				<span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">s</span><span class="p">],</span><span class="n">s</span><span class="o">&gt;=</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
					<span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">s</span><span class="p">]</span><span class="o">+</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">s</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span><span class="o">%</span><span class="n">M</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">s</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">q</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">f</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">s</span><span class="p">]);</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="poor-god-water"><a href="https://nanti.jisuanke.com/t/31721">Poor God Water</a></h2>

<p>çŸ©é˜µä¹˜ä¸€ä¸‹ã€‚</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;cstdio&gt;
#include&lt;algorithm&gt;
#define mul(a,b,c) (1LL*(a)*(b)%(c))
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">const</span> <span class="n">ll</span> <span class="n">N</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">7</span><span class="p">;</span>
<span class="k">struct</span> <span class="nc">Matrix</span>
<span class="p">{</span>
	<span class="k">static</span> <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>
	<span class="n">ll</span> <span class="n">a</span><span class="p">[</span><span class="n">N</span><span class="p">][</span><span class="n">N</span><span class="p">];</span>
	<span class="n">Matrix</span><span class="p">(</span><span class="n">ll</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">fill</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">n</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">ll</span><span class="o">*</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">n</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="n">Matrix</span><span class="o">::</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">;</span>
<span class="n">Matrix</span> <span class="k">operator</span><span class="o">*</span><span class="p">(</span><span class="k">const</span> <span class="n">Matrix</span> <span class="o">&amp;</span><span class="n">a</span><span class="p">,</span><span class="k">const</span> <span class="n">Matrix</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Matrix</span> <span class="n">r</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">r</span><span class="p">.</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">r</span><span class="p">.</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">r</span><span class="p">.</span><span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">k</span><span class="p">)</span>
				<span class="n">r</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">mul</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">],</span><span class="n">b</span><span class="p">.</span><span class="n">a</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">M</span><span class="p">))</span><span class="o">%</span><span class="n">M</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">Matrix</span> <span class="nf">pow</span><span class="p">(</span><span class="n">Matrix</span> <span class="n">a</span><span class="p">,</span><span class="n">ll</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">Matrix</span> <span class="n">r</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(;</span> <span class="n">b</span><span class="p">;</span> <span class="n">b</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
		<span class="k">if</span><span class="p">(</span><span class="n">b</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
	<span class="k">return</span> <span class="n">r</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
	<span class="n">ll</span> <span class="n">t</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">ans</span><span class="p">;</span>
	<span class="k">for</span><span class="p">(</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%lld"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span> <span class="n">t</span><span class="o">--</span><span class="p">;)</span>
	<span class="p">{</span>
		<span class="n">scanf</span><span class="p">(</span><span class="s">"%lld"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">);</span>
		<span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">n</span><span class="o">==</span><span class="mi">1</span><span class="o">?</span><span class="mi">3</span><span class="o">:</span><span class="mi">9</span><span class="p">);</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">Matrix</span> <span class="n">A</span><span class="p">,</span><span class="n">P</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">4</span><span class="p">][</span><span class="mi">7</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">6</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">7</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">P</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">P</span><span class="p">[</span><span class="mi">8</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
		<span class="n">A</span><span class="o">=</span><span class="n">pow</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">A</span><span class="p">;</span>
		<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">ans</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="n">ans</span><span class="o">=</span><span class="p">(</span><span class="n">ans</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">%</span><span class="n">M</span><span class="p">;</span>
		<span class="n">printf</span><span class="p">(</span><span class="s">"%lld</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">ans</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
:ET