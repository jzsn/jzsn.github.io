I"<h2 id="project-04-01-multiple-uses-two-dimensional-fast-fourier-transform">PROJECT 04-01 [Multiple Uses] Two-Dimensional Fast Fourier Transform</h2>

<p>The purpose of this project is to develop a 2-D FFT program â€œpackageâ€ that will be used in several other projects that follow. Your implementation must have the capabilities to:</p>

<ol>
  <li>Multiply the input image by $(-1)^{x+y}$ to center the transform for filtering.</li>
  <li>Multiply the resulting (complex) array by a real function (in the sense that the the real coefficients multiply both the real and imaginary parts of the transforms). Recall that multiplication of two images is done on pairs of corresponding elements.</li>
  <li>Compute the inverse Fourier transform.</li>
  <li>Multiply the result by $(-1)^{x+y}$ and take the real part.</li>
  <li>Compute the spectrum.</li>
</ol>

<p>Basically, this project implements Fig. 4.5. If you are using MATLAB, then your Fourier transform program will not be limited to images whose size are integer powers of 2. If you are implementing the program yourself, then the FFT routine you are using may be limited to integer powers of 2. In this case, you may need to zoom or shrink an image to the proper size by using the program you developed in Project 02-04.</p>

<p>An approximation: To simplify this and the following projects (with the exception of Project 04-05), you may ignore image padding (Section 4.6.3). Although your results will not be strictly correct, significant simplifications will be gained not only in image sizes, but also in the need for cropping the final result. The principles will not be affected by this approximation.</p>

<h3 id="åŸç†">åŸç†</h3>

<ol>
  <li>å› ä¸º$\Im[f(x,y)(-1)^{x+y}]=F(u-M/2,v-N/2)$ï¼Œå› æ­¤é¢‘ç‡åŸŸçš„ä¸­å¿ƒå¹³ç§»å¯ä»¥ç”±åŸå›¾ä¹˜ä¸Š$(-1)^{x+y}$å®ç°ã€‚</li>
  <li>ç›´æ¥åœ¨å¾—åˆ°çš„å¤æ•°æ•°ç»„ä¸Šä¹˜ä¸Šå®å‡½æ•°å³å¯ã€‚</li>
  <li>å¯ä»¥è°ƒç”¨ matlab çš„ ifft2</li>
  <li>åŒï¼ˆ1ï¼‰ï¼Œè·å–å®éƒ¨å¯ä»¥ç”¨<code class="highlighter-rouge">real</code>å‡½æ•°</li>
  <li>å¤æ•°çš„æ¨¡å¯ä»¥ç”¨<code class="highlighter-rouge">abs</code>å‡½æ•°</li>
</ol>

<h3 id="ä»£ç ">ä»£ç </h3>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">f</span><span class="o">=</span><span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig0418(a).tif'</span><span class="p">);</span><span class="c1">%è¾“å…¥å›¾ç‰‡</span>
<span class="n">H</span><span class="o">=</span><span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig0418(a).tif'</span><span class="p">);</span><span class="c1">%å®å‡½æ•°</span>

<span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">]</span><span class="o">=</span><span class="nb">size</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="n">P</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">;</span><span class="n">Q</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">;</span>

<span class="n">fp</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">);</span>
<span class="n">fp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">);</span><span class="c1">%å›¾åƒå¡«å……</span>

<span class="p">[</span><span class="n">Y</span><span class="p">,</span><span class="n">X</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Q</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">P</span><span class="p">);</span>
<span class="nb">ones</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.^</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">);</span>

<span class="n">F</span><span class="o">=</span><span class="nb">fft2</span><span class="p">(</span><span class="nb">ones</span><span class="o">.*</span><span class="n">fp</span><span class="p">);</span><span class="c1">%ç”¨ï¼ˆ-1ï¼‰^(x+y)ä¹˜ä»¥è¾“å…¥å›¾åƒ,æ¥å®ç°ä¸­å¿ƒåŒ–å˜æ¢</span>
<span class="c1">%(-1)^(x+y)*f(x,y)çš„å‚…é‡Œå¶å˜æ¢ç­‰äºfftshift(fft2(f,P,Q));</span>
<span class="c1">% å› æ­¤ä¸Šé¢å¯ç”¨ä¸€å¥F=fftshift(fft2(f,P,Q)); ä»£æ›¿</span>

<span class="n">G</span><span class="o">=</span><span class="n">H</span><span class="o">.*</span><span class="n">F</span><span class="p">;</span><span class="c1">%é¢‘ç‡åŸŸç›¸ä¹˜ï¼Œè¿™é‡ŒHæ˜¯å®å‡½æ•°</span>

<span class="n">g</span><span class="o">=</span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft2</span><span class="p">(</span><span class="n">G</span><span class="p">));</span><span class="c1">%åå˜æ¢å¹¶å–ç»“æœçš„å®éƒ¨</span>
<span class="n">g</span><span class="o">=</span><span class="nb">ones</span><span class="o">.*</span><span class="n">g</span><span class="p">;</span>
<span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">);</span><span class="c1">%åœ¨gï¼ˆx,yï¼‰æå–M*Nå·¦ä¸Šè±¡é™</span>

<span class="n">I</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">F</span><span class="p">);</span><span class="c1">% å–é¢‘è°±ï¼Œå³æ¨¡é•¿ï¼Œç›´æ¥è°ƒç”¨abså³å¯</span>
</code></pre></div></div>

<h2 id="project-04-02-fourier-spectrum-and-average-value">PROJECT 04-02 Fourier Spectrum and Average Value</h2>

<ol>
  <li>Download Fig. 4.18(a) and compute its (centered) Fourier spectrum.</li>
  <li>Display the spectrum.</li>
  <li>Use your result in (a) to compute the average value of the image.</li>
</ol>

<h3 id="åŸç†-1">åŸç†</h3>

<p>ç›´æµåˆ†é‡$F(0,0)=\frac{1}{MN}\sum_{x=0}^M\sum_{y=0}^N$ä¸ºå›¾åƒåƒç´ çš„å‡å€¼ã€‚</p>

<h3 id="ä»£ç -1">ä»£ç </h3>

<p>ä¸ºäº†èƒ½å¤Ÿæ›´åŠ æ¸…æ¥šæ˜¾ç¤ºé¢‘è°±å›¾çš„æƒ…å†µï¼Œè¾“å‡ºé¢‘è°±å›¾çš„æ—¶å€™åšäº†ä¸€æ¬¡å¯¹æ•°å˜æ¢ã€‚</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">close</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clear</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig0418(a).tif'</span><span class="p">);</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">double</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
<span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">I</span><span class="p">));</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">s</span> <span class="p">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">n</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="nb">uint8</span><span class="p">(</span><span class="n">I</span><span class="p">)),</span><span class="nb">title</span><span class="p">(</span><span class="n">avg</span><span class="p">);</span>
<span class="n">sp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fft2</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)));</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="nb">uint8</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="p">)),[]);</span>
</code></pre></div></div>

<h3 id="ç»“æœ">ç»“æœ</h3>

<p>å¦‚å›¾ï¼Œè®¡ç®—å‡ºçš„å¹³å‡å€¼ä¸º 207.315ã€‚</p>

<p><img src="/assets/image/2019-09-26-1.jpg" alt="4.2" /></p>

<h2 id="project-04-03-lowpass-filtering">PROJECT 04-03 Lowpass Filtering</h2>

<ol>
  <li>Implement the Gaussian lowpass filter in Eq. (4.3-7). You must be able to specify the size, M x N, of the resulting 2D function. In addition, you must be able to specify where the 2D location of the center of the Gaussian function.</li>
  <li>Download Fig. 4.11(a) [this image is the same as Fig. 4.18(a)] and lowpass filter it to obtain Fig. 4.18(c).</li>
</ol>

<h3 id="åŸç†-2">åŸç†</h3>

<p>äºŒç»´é«˜æ–¯æ»¤æ³¢å™¨çš„æ–¹ç¨‹ä¸ºï¼š$H(u,v)=e^{-D^2(u,v)/2\sigma^2}$ï¼Œå…¶ä¸­$D(u,v)$ä¸ºè·å‚…é‡Œå¶å˜æ¢åŸç‚¹çš„è·ç¦»ï¼Œ$\sigma$ä¸ºé«˜æ–¯æ›²çº¿æ‰©å±•çš„ç¨‹åº¦ã€‚</p>

<h3 id="ä»£ç -2">ä»£ç </h3>

<p>è¿™é‡Œå¤§éƒ¨åˆ†å†…å®¹å¯ä»¥å¤ç”¨ç¬¬ä¸€é—®çš„çš„ä»£ç ã€‚</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">close</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clear</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig0418(a).tif'</span><span class="p">);</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">mat2gray</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span><span class="p">;</span> <span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">;</span>

<span class="c1">%ç”Ÿæˆå®çš„å¯¹ç§°çš„æ»¤æ³¢å‡½æ•°Hï¼Œä¸­å¿ƒåœ¨ï¼ˆM,Nï¼‰</span>
<span class="n">alf</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">P</span>
    <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">Q</span>
        <span class="n">H</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="n">P</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">Q</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)/(</span><span class="mi">2</span><span class="o">*</span><span class="n">alf</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span>
    <span class="k">end</span>
<span class="k">end</span>


<span class="n">fp</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">);</span>
<span class="n">fp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">);</span><span class="c1">%å›¾åƒå¡«å……</span>

<span class="p">[</span><span class="n">Y</span><span class="p">,</span><span class="n">X</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Q</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">P</span><span class="p">);</span>
<span class="nb">ones</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.^</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">);</span>

<span class="n">F</span><span class="o">=</span><span class="nb">fft2</span><span class="p">(</span><span class="nb">ones</span><span class="o">.*</span><span class="n">fp</span><span class="p">);</span><span class="c1">%ç”¨ï¼ˆ-1ï¼‰^(x+y)ä¹˜ä»¥è¾“å…¥å›¾åƒ,æ¥å®ç°ä¸­å¿ƒåŒ–å˜æ¢</span>
<span class="c1">%(-1)^(x+y)*f(x,y)çš„å‚…é‡Œå¶å˜æ¢ç­‰äºfftshift(fft2(f,P,Q));</span>
<span class="c1">% å› æ­¤ä¸Šé¢å¯ç”¨ä¸€å¥F=fftshift(fft2(f,P,Q)); ä»£æ›¿</span>

<span class="n">G</span><span class="o">=</span><span class="n">H</span><span class="o">.*</span><span class="n">F</span><span class="p">;</span><span class="c1">%é¢‘ç‡åŸŸç›¸ä¹˜ï¼Œè¿™é‡ŒHæ˜¯å®å‡½æ•°</span>

<span class="n">g</span><span class="o">=</span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft2</span><span class="p">(</span><span class="n">G</span><span class="p">));</span><span class="c1">%åå˜æ¢å¹¶å–ç»“æœçš„å®éƒ¨</span>
<span class="n">g</span><span class="o">=</span><span class="nb">ones</span><span class="o">.*</span><span class="n">g</span><span class="p">;</span>
<span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">);</span><span class="c1">%åœ¨gï¼ˆx,yï¼‰æå–M*Nå·¦ä¸Šè±¡é™</span>


<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'åŸå›¾'</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">H</span><span class="p">),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'æ»¤æ³¢å‡½æ•°'</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'é«˜æ–¯ä½é€šæ»¤æ³¢åçš„å›¾åƒ'</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="ç»“æœ-1">ç»“æœ</h3>

<p><img src="/assets/image/2019-09-26-2.jpg" alt="4.3" /></p>

<h2 id="project-04-04-highpass-filtering-using-a-lowpass-image">PROJECT 04-04 Highpass Filtering Using a Lowpass Image</h2>

<ol>
  <li>Subtract your image in Project 04-03(b) from the original to obtain a sharpened image, as in Eq. (4.4-14). You will note that the resulting image does not resemble the Gaussian highpass results in Fig. 4.26. Explain why this is so.</li>
  <li>Adjust the variance of your Gaussian lowpass filter until the result obtained by image subtraction looks similar to Fig. 4.26(c). Explain your result.</li>
</ol>

<h3 id="åŸç†-3">åŸç†</h3>

<p>åˆ©ç”¨ä¸‹å¼å¯ä»¥å¾—åˆ°é«˜é€šæ»¤æ³¢çš„å›¾åƒ</p>

<p>$f_{hp}(x,y)=f(x,y)-f_{lp}(x,y)$</p>

<p>å…¶ä¸­$f_{lp}$å³ä¸º PROJECT 04-03ï¼Œå³ä¸Šä¸€ä¸ªé€šè¿‡é«˜æ–¯æ»¤æ³¢åçš„å›¾åƒã€‚</p>

<h3 id="ä»£ç -3">ä»£ç </h3>

<p>åœ¨ä¸Šä¸€é—®çš„åŸºç¡€ä¸Šç»§ç»­åšå³å¯ï¼Œç”¨åŸå›¾å›¾åƒå‡å»é«˜æ–¯ä½é€šæ»¤æ³¢å¤„ç†çš„å›¾åƒã€‚</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">close</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clear</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig0418(a).tif'</span><span class="p">);</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">mat2gray</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="p">[</span><span class="n">M</span><span class="p">,</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">M</span><span class="p">;</span> <span class="n">Q</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">;</span>

<span class="c1">%ç”Ÿæˆå®çš„å¯¹ç§°çš„æ»¤æ³¢å‡½æ•°ï¼Œä¸­å¿ƒåœ¨ï¼ˆM,Nï¼‰</span>
<span class="n">alf</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span><span class="c1">%ç¬¬äºŒé—®æŠŠè¿™é‡Œæ”¹æˆ200</span>
<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">P</span>
    <span class="k">for</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">:</span><span class="n">Q</span>
        <span class="n">H</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">i</span><span class="o">-</span><span class="n">P</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">Q</span><span class="p">/</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)/(</span><span class="mi">2</span><span class="o">*</span><span class="n">alf</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span>
    <span class="k">end</span>
<span class="k">end</span>

<span class="n">fp</span><span class="o">=</span><span class="nb">zeros</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">);</span>
<span class="n">fp</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">)</span><span class="o">=</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">);</span><span class="c1">%å›¾åƒå¡«å……</span>

<span class="p">[</span><span class="n">Y</span><span class="p">,</span><span class="n">X</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Q</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">P</span><span class="p">);</span>
<span class="nb">ones</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.^</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">);</span>

<span class="n">F</span><span class="o">=</span><span class="nb">fft2</span><span class="p">(</span><span class="nb">ones</span><span class="o">.*</span><span class="n">fp</span><span class="p">);</span><span class="c1">%ç”¨ï¼ˆ-1ï¼‰^(x+y)ä¹˜ä»¥è¾“å…¥å›¾åƒ,æ¥å®ç°ä¸­å¿ƒåŒ–å˜æ¢</span>
<span class="c1">%(-1)^(x+y)*f(x,y)çš„å‚…é‡Œå¶å˜æ¢ç­‰äºfftshift(fft2(f,P,Q));</span>
<span class="c1">% å› æ­¤ä¸Šé¢å¯ç”¨ä¸€å¥F=fftshift(fft2(f,P,Q)); ä»£æ›¿</span>

<span class="n">G</span><span class="o">=</span><span class="n">H</span><span class="o">.*</span><span class="n">F</span><span class="p">;</span><span class="c1">%é¢‘ç‡åŸŸç›¸ä¹˜ï¼Œè¿™é‡ŒHæ˜¯å®å‡½æ•°</span>

<span class="n">g</span><span class="o">=</span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft2</span><span class="p">(</span><span class="n">G</span><span class="p">));</span><span class="c1">%åå˜æ¢å¹¶å–ç»“æœçš„å®éƒ¨</span>
<span class="n">g</span><span class="o">=</span><span class="nb">ones</span><span class="o">.*</span><span class="n">g</span><span class="p">;</span>
<span class="n">g</span><span class="o">=</span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">N</span><span class="p">);</span><span class="c1">%åœ¨gï¼ˆx,yï¼‰æå–M*Nå·¦ä¸Šè±¡é™</span>


<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">f</span><span class="p">),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'åŸå›¾'</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">H</span><span class="p">),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'æ»¤æ³¢å‡½æ•°'</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">g</span><span class="p">),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'é«˜æ–¯ä½é€šæ»¤æ³¢åçš„å›¾åƒ'</span><span class="p">);</span>

<span class="n">g</span><span class="o">=</span><span class="nb">im2double</span><span class="p">(</span><span class="n">g</span><span class="p">);</span><span class="n">f</span><span class="o">=</span><span class="nb">im2double</span><span class="p">(</span><span class="n">f</span><span class="p">);</span><span class="n">gmask</span><span class="o">=</span><span class="n">f</span><span class="o">-</span><span class="n">g</span><span class="p">;</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">gmask</span><span class="p">);</span><span class="nb">title</span><span class="p">(</span><span class="s1">'é’åŒ–æ¨¡æ¿'</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="ç»“æœ-2">ç»“æœ</h3>

<p>ç”¨åŸå›¾å‡å»é«˜æ–¯ä½é€šæ»¤æ³¢å¤„ç†åçš„å›¾åƒåç¡®å®å˜æ¨¡ç³Šäº†ã€‚å’Œè¯¾æœ¬ä¸Šçš„å›¾ç‰‡å¯¹æ¯”ï¼Œæˆ‘è¿™é‡Œç”Ÿæˆçš„å›¾ç‰‡è¾¹ç¼˜æ›´åŠ æ¸…æ¥šä¸€äº›ï¼ˆä¸»è§‚ä¸Šæ„Ÿè§‰ï¼‰ã€‚å¦‚æœæ’é™¤å°åˆ·çš„é—®é¢˜ï¼Œè€ƒè™‘åˆ°å…¬å¼ä¸Šä¸ç›´æ¥åšé«˜æ–¯é«˜é€šæ»¤æ³¢æ˜¯ç­‰ä»·çš„ï¼Œå¯èƒ½æ˜¯å› ä¸ºä¸åŒçš„è®¡ç®—æ–¹å¼å¯¼è‡´äº†ä¸åŒçš„æµ®ç‚¹æ•°è¯¯å·®é€ æˆçš„ã€‚</p>

<p><img src="/assets/image/2019-09-26-3.jpg" alt="4.4" /></p>

<p>è°ƒæ•´ç¬¬ 8 è¡Œä¸º<code class="highlighter-rouge">alf=200</code>ï¼Œå¯ä»¥çœ‹åˆ°æ¨¡æ¿å˜å¾—æ›´æ¨¡ç³Šäº†ï¼Œæ›´åŠ æ¥è¿‘è¯¾æœ¬ã€‚</p>

<p><img src="/assets/image/2019-09-26-3.jpg" alt="4.4" /></p>

<h2 id="project-04-05-correlation-in-the-frequency-domain">PROJECT 04-05 Correlation in the Frequency Domain</h2>

<p>Download Figs. 4.41(a) and (b) and duplicate Example 4.11 to obtain Fig. 4.41(e). Give the (x,y) coordinates of the location of the maximum value in the 2D correlation function. There is no need to plot the profile in Fig. 4.41(f).</p>

<h3 id="ä»£ç -4">ä»£ç </h3>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">close</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span><span class="nb">clear</span> <span class="nb">all</span><span class="p">;</span>
<span class="n">f1</span> <span class="o">=</span> <span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig4.41(a).jpg'</span><span class="p">);</span>
<span class="n">f2</span> <span class="o">=</span> <span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig4.41(b).jpg'</span><span class="p">);</span>
<span class="p">[</span><span class="n">M1</span><span class="p">,</span> <span class="n">N1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">f1</span><span class="p">);</span>
<span class="p">[</span><span class="n">M2</span><span class="p">,</span> <span class="n">N2</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">f2</span><span class="p">);</span>
<span class="n">P</span> <span class="o">=</span> <span class="mi">298</span><span class="p">;</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">298</span><span class="p">;</span>
<span class="p">[</span><span class="n">Y</span><span class="p">,</span><span class="n">X</span><span class="p">]</span><span class="o">=</span><span class="nb">meshgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">Q</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">P</span><span class="p">);</span>
<span class="nb">ones</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.^</span><span class="p">(</span><span class="n">X</span><span class="o">+</span><span class="n">Y</span><span class="p">);</span>
<span class="n">fp1</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">);</span>
<span class="n">fp2</span> <span class="o">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">);</span>
<span class="n">fp1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">N1</span><span class="p">)</span> <span class="o">=</span> <span class="n">f1</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">N1</span><span class="p">);</span>
<span class="n">fp2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">N2</span><span class="p">)</span> <span class="o">=</span> <span class="n">f2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">M2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">N2</span><span class="p">);</span>
<span class="n">Fp1</span> <span class="o">=</span> <span class="nb">fft2</span><span class="p">(</span><span class="nb">ones</span><span class="o">.*</span><span class="n">fp1</span><span class="p">);</span>
<span class="n">Fp2</span> <span class="o">=</span> <span class="nb">fft2</span><span class="p">(</span><span class="nb">ones</span><span class="o">.*</span><span class="n">fp2</span><span class="p">);</span>
<span class="n">Fp</span> <span class="o">=</span> <span class="n">Fp2</span> <span class="o">.*</span> <span class="nb">conj</span><span class="p">(</span><span class="n">Fp1</span><span class="p">);</span><span class="c1">% æ±‚å…±è½­</span>
<span class="n">fp</span> <span class="o">=</span> <span class="nb">ifft2</span><span class="p">(</span><span class="n">Fp</span><span class="p">);</span>
<span class="n">fp</span> <span class="o">=</span> <span class="nb">real</span><span class="p">(</span> <span class="nb">ones</span><span class="o">.*</span> <span class="n">fp</span><span class="p">);</span>
<span class="n">fp</span> <span class="o">=</span> <span class="n">mat2gray</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="n">max_value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">fp</span><span class="p">));</span>
<span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">find</span><span class="p">(</span><span class="n">fp</span> <span class="o">==</span> <span class="n">max_value</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">f1</span><span class="p">),</span><span class="nb">title</span><span class="p">([</span><span class="s1">'max value is : '</span><span class="p">,</span> <span class="nb">num2str</span><span class="p">(</span><span class="n">max_value</span><span class="p">)]);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">f2</span><span class="p">),</span><span class="nb">title</span><span class="p">([</span><span class="s1">'('</span><span class="p">,</span> <span class="nb">num2str</span><span class="p">(</span><span class="n">row</span><span class="p">),</span> <span class="s1">','</span><span class="p">,</span> <span class="nb">num2str</span><span class="p">(</span><span class="n">col</span><span class="p">),</span><span class="s1">')'</span><span class="p">]);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="ç»“æœ-3">ç»“æœ</h3>

<p>å¦‚å›¾ï¼Œä»å·¦åˆ°å³åˆ†åˆ«ä¸ºåŸå›¾ã€æ©è†œ/éœ€è¦æŸ¥æ‰¾çš„å›¾åƒã€å…±è½­ç”Ÿæˆçš„ç›¸å…³å›¾ï¼ˆå…¶å®å¹¶æ²¡æœ‰è¦æ±‚è¾“å‡ºï¼‰ã€‚</p>

<p><img src="/assets/image/2019-09-26-4.jpg" alt="4.6" /></p>

<p>æœ€å¤§å€¼å‡ºç°åœ¨(191,193)çš„ä½ç½®ï¼Œç¬¦åˆé¢„æœŸã€‚</p>

<h2 id="ä»¥-figure44-ä¸ºä¾‹æ£€éªŒè°±å¹³é¢éšç€å›¾åƒæ—‹è½¬è€Œæ—‹è½¬çš„æ€§è´¨">ä»¥ figure4.4 ä¸ºä¾‹æ£€éªŒè°±å¹³é¢éšç€å›¾åƒæ—‹è½¬è€Œæ—‹è½¬çš„æ€§è´¨</h2>

<h3 id="åŸç†-4">åŸç†</h3>

<p>å¼•å…¥æåæ ‡$x=r\cos\theta,y=r\sin\theta,u=\omega\cos\phi,v=\omega\sin\phi$ï¼Œè®¡ç®—å¯å¾—$f(r,\theta+\theta_0)\iff F(\omega,\phi+\theta_0)$</p>

<h3 id="ä»£ç -5">ä»£ç </h3>

<p>åœ¨ PROJECT 04-02 çš„ä»£ç ä¸Šç•¥ä½œä¿®æ”¹å³å¯ã€‚</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">close</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clear</span> <span class="nb">all</span><span class="p">;</span><span class="nb">clc</span><span class="p">;</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">imread</span><span class="p">(</span><span class="s1">'Fig4.04(a).jpg'</span><span class="p">);</span>
<span class="n">I</span> <span class="o">=</span> <span class="nb">double</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
<span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="nb">size</span><span class="p">(</span><span class="n">I</span><span class="p">);</span>
<span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">I</span><span class="p">));</span>
<span class="n">avg</span> <span class="o">=</span> <span class="n">s</span> <span class="p">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">n</span><span class="p">);</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="nb">uint8</span><span class="p">(</span><span class="n">I</span><span class="p">)),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'åŸå›¾'</span><span class="p">);</span>
<span class="n">sp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fft2</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)));</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="nb">uint8</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="p">)),[]),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'åŸå›¾é¢‘è°±'</span><span class="p">);</span>
<span class="n">I</span><span class="o">=</span><span class="n">imrotate</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">45</span><span class="p">);</span>
<span class="n">sp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fft2</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)));</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="nb">uint8</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="p">)),[]),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'åŸå›¾æ—‹è½¬45Â°çš„é¢‘è°±'</span><span class="p">);</span>
<span class="n">I</span><span class="o">=</span><span class="n">imrotate</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">45</span><span class="p">);</span>
<span class="n">sp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">fftshift</span><span class="p">(</span><span class="nb">fft2</span><span class="p">(</span><span class="n">I</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="p">)));</span>
<span class="nb">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="nb">imshow</span><span class="p">(</span><span class="nb">uint8</span><span class="p">(</span><span class="nb">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">sp</span><span class="p">)),[]),</span><span class="nb">title</span><span class="p">(</span><span class="s1">'åŸå›¾æ—‹è½¬90Â°çš„é¢‘è°±'</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="ç»“æœ-4">ç»“æœ</h3>

<p>å¯ä»¥çœ‹å‡ºï¼Œå½“åŸå›¾è¿›è¡Œæ—‹è½¬æ—¶ï¼Œé¢‘è°±å›¾ç¡®å®ä»¥ç›¸åŒçš„è§’åº¦å’Œæ–¹å‘æ—‹è½¬ã€‚</p>

<p><img src="/assets/image/2019-09-26-5.jpg" alt="4.6" /></p>
:ET